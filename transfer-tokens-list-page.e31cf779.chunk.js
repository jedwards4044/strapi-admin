"use strict";(self.webpackChunkmy_project=self.webpackChunkmy_project||[]).push([[9600],{92668:(j,v,t)=>{t.d(v,{Z:()=>H});var e=t(53547),o=t(94487),N=t(6090),m=t(62351),k=t(78549),U=t(75878),i=t(5504),V=t(45697),n=t.n(V),A=t(86896),b=t(16550),x=t(50781),D=t(37527),O=t(34263);const T=({tokenName:s,onClickDelete:l,tokenType:c})=>{const{formatMessage:E}=(0,A.Z)(),{trackUsage:u}=(0,i.useTracking)(),[f,g]=(0,e.useState)(!1),C=()=>{g(!1),u("willDeleteToken",{tokenType:c}),l()};return e.createElement(x.x,{paddingLeft:1,onClick:d=>d.stopPropagation()},e.createElement(D.h,{onClick:()=>{g(!0)},label:E({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${s}`}),name:"delete",noBorder:!0,icon:e.createElement(O.Z,null)}),e.createElement(i.ConfirmDialog,{onToggleDialog:()=>g(!1),onConfirm:C,isOpen:f}))};T.propTypes={tokenName:n().string.isRequired,onClickDelete:n().func.isRequired,tokenType:n().string.isRequired};const F=T;var z=t(2953),$=t(88972);const G={edit:{id:"app.component.table.edit",defaultMessage:"Edit {target}"},read:{id:"app.component.table.read",defaultMessage:"Read {target}"}},w=(0,$.default)(i.Link)`
  svg {
    path {
      fill: ${({theme:s})=>s.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:s})=>s.colors.neutral800};
      }
    }
  }
`,P=({tokenName:s,tokenId:l,buttonType:c,children:E})=>{const{formatMessage:u}=(0,A.Z)(),{location:{pathname:f}}=(0,b.k6)();return e.createElement(w,{to:`${f}/${l}`,title:u(G[c],{target:s})},E)};P.propTypes={tokenName:n().string.isRequired,tokenId:n().oneOfType([n().string,n().number]).isRequired,buttonType:n().string,children:n().node.isRequired},P.defaultProps={buttonType:"edit"};const B=P,h=({tokenName:s,tokenId:l})=>e.createElement(B,{tokenName:s,tokenId:l,buttonType:"read"},e.createElement(z.Z,null));h.propTypes={tokenName:n().string.isRequired,tokenId:n().oneOfType([n().string,n().number]).isRequired};const p=h;var y=t(36670);const I=({tokenName:s,tokenId:l})=>e.createElement(B,{tokenName:s,tokenId:l},e.createElement(y.Z,null));I.propTypes={tokenName:n().string.isRequired,tokenId:n().oneOfType([n().string,n().number]).isRequired};const L=I,S=({permissions:s,headers:l,contentType:c,isLoading:E,tokens:u,onConfirmDelete:f,tokenType:g})=>{const{canDelete:C,canUpdate:d,canRead:R}=s,Z=C||d||R,[{query:M}]=(0,i.useQueryParams)(),{formatMessage:W}=(0,A.Z)(),[,Y]=M?M.sort.split(":"):"ASC",{push:K,location:{pathname:Q}}=(0,b.k6)(),{trackUsage:a}=(0,i.useTracking)(),X=u.sort((r,q)=>{const J=r.name.localeCompare(q.name);return Y==="DESC"?-J:J});return e.createElement(i.DynamicTable,{headers:l,contentType:c,rows:u,withBulkActions:Z,isLoading:E,onConfirmDelete:f},e.createElement(o.p,null,X.map(r=>e.createElement(N.Tr,{key:r.id,...(0,i.onRowClick)({fn(){a("willEditTokenFromList",{tokenType:g}),K(`${Q}/${r.id}`)},condition:d})},e.createElement(m.Td,{maxWidth:(0,i.pxToRem)(250)},e.createElement(k.Z,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0},r.name)),e.createElement(m.Td,{maxWidth:(0,i.pxToRem)(250)},e.createElement(k.Z,{textColor:"neutral800",ellipsis:!0},r.description)),e.createElement(m.Td,null,e.createElement(k.Z,{textColor:"neutral800"},e.createElement(i.RelativeTime,{timestamp:new Date(r.createdAt)}))),e.createElement(m.Td,null,r.lastUsedAt&&e.createElement(k.Z,{textColor:"neutral800"},e.createElement(i.RelativeTime,{timestamp:new Date(r.lastUsedAt),customIntervals:[{unit:"hours",threshold:1,text:W({id:"Settings.apiTokens.lastHour",defaultMessage:"last hour"})}]}))),Z&&e.createElement(m.Td,null,e.createElement(U.k,{justifyContent:"end"},d&&e.createElement(L,{tokenName:r.name,tokenId:r.id}),!d&&R&&e.createElement(p,{tokenName:r.name,tokenId:r.id}),C&&e.createElement(F,{tokenName:r.name,onClickDelete:()=>f(r.id),tokenType:g})))))))};S.propTypes={tokens:n().array,permissions:n().shape({canRead:n().bool,canDelete:n().bool,canUpdate:n().bool}).isRequired,headers:n().arrayOf(n().shape({cellFormatter:n().func,key:n().string.isRequired,metadatas:n().shape({label:n().string.isRequired,sortable:n().bool}).isRequired,name:n().string.isRequired})),contentType:n().string.isRequired,isLoading:n().bool,onConfirmDelete:n().func,tokenType:n().string.isRequired},S.defaultProps={tokens:[],headers:[],isLoading:!1,onConfirmDelete(){}};const H=S},81966:(j,v,t)=>{t.d(v,{Z:()=>e,f:()=>o});const e="api-token",o="transfer-token"},68446:(j,v,t)=>{t.r(v),t.d(v,{default:()=>B});var e=t(53547),o=t(5504),N=t(7694),m=t(36364),k=t(57713),U=t(79371),i=t(26789),V=t(19442),n=t(12978),A=t(80129),b=t.n(A),x=t(86896),D=t(75336),O=t(16550),T=t(81966),F=t(92668);const $=[{name:"name",key:"name",metadatas:{label:{id:"Settings.tokens.ListView.headers.name",defaultMessage:"Name"},sortable:!0}},{name:"description",key:"description",metadatas:{label:{id:"Settings.tokens.ListView.headers.description",defaultMessage:"Description"},sortable:!1}},{name:"createdAt",key:"createdAt",metadatas:{label:{id:"Settings.tokens.ListView.headers.createdAt",defaultMessage:"Created at"},sortable:!1}},{name:"lastUsedAt",key:"lastUsedAt",metadatas:{label:{id:"Settings.tokens.ListView.headers.lastUsedAt",defaultMessage:"Last used"},sortable:!1}}],w=()=>{(0,o.useFocusWhenNavigate)();const h=(0,D.useQueryClient)(),{formatMessage:p}=(0,x.Z)(),y=(0,o.useNotification)(),I=(0,N.v9)(m._),{allowedActions:{canCreate:L,canDelete:S,canUpdate:H,canRead:s}}=(0,o.useRBAC)(I.settings["transfer-tokens"]),{push:l}=(0,O.k6)(),{trackUsage:c}=(0,o.useTracking)(),{startSection:E}=(0,o.useGuidedTour)(),u=(0,e.useRef)(E),{get:f,del:g}=(0,o.useFetchClient)();(0,e.useEffect)(()=>{u.current&&u.current("transferTokens")},[]),(0,e.useEffect)(()=>{l({search:b().stringify({sort:"name:ASC"},{encode:!1})})},[l]);const C=$.map(a=>({...a,metadatas:{...a.metadatas,label:p(a.metadatas.label)}})),{data:d,status:R,isFetching:Z}=(0,D.useQuery)(["transfer-tokens"],async()=>{c("willAccessTokenList",{tokenType:T.f});const{data:{data:a}}=await f("/admin/transfer/tokens");return c("didAccessTokenList",{number:a.length,tokenType:T.f}),a},{enabled:s,onError(a){console.log("error",a),a?.response?.data?.error?.details?.code==="INVALID_TOKEN_SALT"?y({type:"warning",message:{id:"notification.error.invalid.configuration",defaultMessage:"You have an invalid configuration, check your server log for more information."}}):y({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),M=s&&(R!=="success"&&R!=="error"||R==="success"&&Z),W=(0,D.useMutation)(async a=>{await g(`/admin/transfer/tokens/${a}`)},{async onSuccess(){await h.invalidateQueries(["transfer-tokens"])},onError(a){a?.response?.data?.data?y({type:"warning",message:a.response.data.data}):a?.response?.data?.error?.details?.code==="INVALID_TOKEN_SALT"?y({type:"warning",message:{id:"notification.error.invalid.configuration",defaultMessage:"You have an invalid configuration, check your server log for more information."}}):y({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),Y=s&&d,K=s&&!d&&!L,Q=s&&!d&&L;return e.createElement(k.o,{"aria-busy":M},e.createElement(o.SettingsPageTitle,{name:"Transfer Tokens"}),e.createElement(U.T,{title:p({id:"Settings.transferTokens.title",defaultMessage:"Transfer Tokens"}),subtitle:p({id:"Settings.transferTokens.description",defaultMessage:'"List of generated transfer tokens"'}),primaryAction:L?e.createElement(o.LinkButton,{"data-testid":"create-transfer-token-button",startIcon:e.createElement(n.Z,null),size:"S",onClick:()=>c("willAddTokenFromList",{tokenType:T.f}),to:"/settings/transfer-tokens/create"},p({id:"Settings.transferTokens.create",defaultMessage:"Create new Transfer Token"})):void 0}),e.createElement(i.D,null,!s&&e.createElement(o.NoPermissions,null),Y&&e.createElement(F.Z,{permissions:{canRead:s,canDelete:S,canUpdate:H},headers:C,contentType:"trasfer-tokens",rows:d,isLoading:M,onConfirmDelete:a=>W.mutateAsync(a),tokens:d,tokenType:T.f}),Q&&e.createElement(o.NoContent,{content:{id:"Settings.transferTokens.addFirstToken",defaultMessage:"Add your first Transfer Token"},action:e.createElement(V.z,{variant:"secondary",startIcon:e.createElement(n.Z,null)},p({id:"Settings.transferTokens.addNewToken",defaultMessage:"Add new Transfer Token"}))}),K&&e.createElement(o.NoContent,{content:{id:"Settings.transferTokens.emptyStateLayout",defaultMessage:"You don\u2019t have any content yet..."}})))},B=()=>{const h=(0,N.v9)(m._);return e.createElement(o.CheckPagePermissions,{permissions:h.settings["transfer-tokens"].main},e.createElement(w,null))}}}]);
