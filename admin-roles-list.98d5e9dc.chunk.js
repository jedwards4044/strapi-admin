"use strict";(self.webpackChunkmy_project=self.webpackChunkmy_project||[]).push([[3455],{7513:(K,x,t)=>{t.r(x),t.d(x,{default:()=>ge});var e=t(53547),n=t(5504),f=t(7694),D=t(36364),y=t(57713),b=t(79371),W=t(19442),U=t(15483),F=t(26789),E=t(51541),S=t(62009),N=t(42403),k=t(6090),C=t(62351),P=t(78549),Q=t(22996),G=t(94487),J=t(70780),X=t(36670),Y=t(34263),V=t(12978),w=t(27361),q=t.n(w),I=t(86896),_=t(16550),ee=t(14900);const te=()=>"todo empty role";var ne=t(75878),le=t(50781),se=t(37527),ae=t(45697),L=t.n(ae);const $=({id:s,name:d,description:l,usersCount:h,icons:c,rowIndex:o,canUpdate:M})=>{const{formatMessage:p}=(0,I.Z)(),[,r]=c,R=p({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:h});return e.createElement(k.Tr,{"aria-rowindex":o,key:s,...M?(0,n.onRowClick)({fn:r.onClick}):{}},e.createElement(C.Td,{maxWidth:(0,n.pxToRem)(130)},e.createElement(P.Z,{ellipsis:!0,textColor:"neutral800"},d)),e.createElement(C.Td,{maxWidth:(0,n.pxToRem)(250)},e.createElement(P.Z,{ellipsis:!0,textColor:"neutral800"},l)),e.createElement(C.Td,null,e.createElement(P.Z,{textColor:"neutral800"},R)),e.createElement(C.Td,null,e.createElement(ne.k,{justifyContent:"flex-end",...n.stopPropagation},c.map((u,v)=>u?e.createElement(le.x,{key:u.label,paddingLeft:v===0?0:1},e.createElement(se.h,{onClick:u.onClick,label:u.label,noBorder:!0,icon:u.icon})):null))))};$.propTypes={id:L().number.isRequired,name:L().string.isRequired,description:L().string.isRequired,usersCount:L().number.isRequired,icons:L().array.isRequired,rowIndex:L().number.isRequired,canUpdate:L().bool},$.defaultProps={canUpdate:!1};const oe=$;var re=t(18172);const ie={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},de=(s,d)=>(0,re.default)(s,l=>{switch(d.type){case"ON_REMOVE_ROLES":{l.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{l.shouldRefetchData=!0,l.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{l.shouldRefetchData=!1,l.roleToDelete=null,l.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{l.roleToDelete=d.id;break}default:return l}}),ce=()=>{(0,n.useFocusWhenNavigate)();const{locale:s}=(0,I.Z)(),d=(0,f.v9)(D._),{isLoading:l,allowedActions:{canCreate:h,canDelete:c,canRead:o,canUpdate:M}}=(0,n.useRBAC)(d.settings.roles),{getData:p,roles:r,isLoading:R}=(0,ee.bF)(!1),[{query:u}]=(0,n.useQueryParams)(),v=u?._q||"",{includes:T}=(0,n.useFilter)(s,{sensitivity:"base"}),O=(0,n.useCollator)(s,{sensitivity:"base"}),j=(r||[]).filter(m=>T(m.name,v)||T(m.description,v)).sort((m,A)=>O.compare(m.name,A.name)||O.compare(m.description,A.description));return(0,e.useEffect)(()=>{!l&&o&&p()},[l,o,p]),{isLoadingForPermissions:l,canCreate:h,canDelete:c,canRead:o,canUpdate:M,isLoading:R,getData:p,sortedRoles:j,roles:r}},ue=({getData:s,canCreate:d,canDelete:l,canUpdate:h})=>{const{formatMessage:c}=(0,I.Z)(),o=(0,n.useNotification)(),[M,p]=(0,e.useState)(!1),{push:r}=(0,_.k6)(),[{selectedRoles:R,showModalConfirmButtonLoading:u,roleToDelete:v},T]=(0,e.useReducer)(de,ie),{post:O}=(0,n.getFetchClient)(),j=async()=>{try{T({type:"ON_REMOVE_ROLES"}),await O("/admin/roles/batch-delete",{ids:[v]}),await s(),T({type:"RESET_DATA_TO_DELETE"})}catch(a){const i=q()(a,["response","payload","data","ids"],null);if(i&&Array.isArray(i)){const he=i.join(`
`);o({type:"warning",message:he})}else o({type:"warning",message:{id:"notification.error"}})}g()},m=(0,e.useCallback)(a=>{r(`/settings/roles/duplicate/${a}`)},[r]),A=()=>r("/settings/roles/new"),B=(0,e.useCallback)(a=>{T({type:"SET_ROLE_TO_DELETE",id:a}),g()},[]),g=()=>p(a=>!a),Z=(0,e.useCallback)(a=>{r(`/settings/roles/${a}`)},[r]),z=(0,e.useCallback)((a,i)=>{a.preventDefault(),a.stopPropagation(),i.usersCount?o({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):B(i.id)},[o,B]),H=(0,e.useCallback)((a,i)=>{a.preventDefault(),a.stopPropagation(),m(i.id)},[m]),Ee=(0,e.useCallback)(a=>[...d?[{onClick:i=>H(i,a),label:c({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(J.Z,null)}]:[],...h?[{onClick:()=>Z(a.id),label:c({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(X.Z,null)}]:[],...l?[{onClick:i=>z(i,a),label:c({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(Y.Z,null)}]:[]],[c,z,H,Z,d,h,l]);return{handleNewRoleClick:A,getIcons:Ee,selectedRoles:R,isWarningDeleteAllOpened:M,showModalConfirmButtonLoading:u,handleToggleModal:g,handleDeleteData:j}},me=()=>{const{formatMessage:s}=(0,I.Z)(),{isLoadingForPermissions:d,canCreate:l,canRead:h,canDelete:c,canUpdate:o,isLoading:M,getData:p,sortedRoles:r}=ce(),{handleNewRoleClick:R,getIcons:u,isWarningDeleteAllOpened:v,showModalConfirmButtonLoading:T,handleToggleModal:O,handleDeleteData:j}=ue({getData:p,canCreate:l,canDelete:c,canUpdate:o}),m=r.length+1,A=6;if(d)return e.createElement(y.o,null,e.createElement(n.LoadingIndicatorPage,null));const B=s({id:"global.roles",defaultMessage:"roles"});return e.createElement(y.o,null,e.createElement(n.SettingsPageTitle,{name:"Roles"}),e.createElement(b.T,{primaryAction:l?e.createElement(W.z,{onClick:R,startIcon:e.createElement(V.Z,null),size:"S"},s({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:B,subtitle:s({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),h&&e.createElement(U.Z,{startActions:e.createElement(n.SearchURLQuery,{label:s({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:B})})}),h&&e.createElement(F.D,null,e.createElement(E.i,{colCount:A,rowCount:m,footer:l?e.createElement(S.c,{onClick:R,icon:e.createElement(V.Z,null)},s({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(N.h,null,e.createElement(k.Tr,{"aria-rowindex":1},e.createElement(C.Th,null,e.createElement(P.Z,{variant:"sigma",textColor:"neutral600"},s({id:"global.name",defaultMessage:"Name"}))),e.createElement(C.Th,null,e.createElement(P.Z,{variant:"sigma",textColor:"neutral600"},s({id:"global.description",defaultMessage:"Description"}))),e.createElement(C.Th,null,e.createElement(P.Z,{variant:"sigma",textColor:"neutral600"},s({id:"global.users",defaultMessage:"Users"}))),e.createElement(C.Th,null,e.createElement(Q.T,null,s({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(G.p,null,r?.map((g,Z)=>e.createElement(oe,{key:g.id,id:g.id,name:g.name,description:g.description,usersCount:g.usersCount,icons:u(g),rowIndex:Z+2,canUpdate:o})))),!m&&!M&&e.createElement(te,null)),e.createElement(n.ConfirmDialog,{isOpen:v,onConfirm:j,isConfirmButtonLoading:T,onToggleDialog:O}))},ge=()=>{const s=(0,f.v9)(D._);return e.createElement(n.CheckPagePermissions,{permissions:s.settings.roles.main},e.createElement(me,null))}},15483:(K,x,t)=>{t.d(x,{Z:()=>f});var e=t(2790),n=t(75878);const f=({startActions:D,endActions:y})=>!D&&!y?null:(0,e.jsxs)(n.k,{justifyContent:"space-between",alignItems:"flex-start",paddingBottom:4,paddingLeft:10,paddingRight:10,children:[(0,e.jsx)(n.k,{gap:2,wrap:"wrap",children:D}),(0,e.jsx)(n.k,{gap:2,shrink:0,wrap:"wrap",children:y})]})},62009:(K,x,t)=>{t.d(x,{c:()=>F});var e=t(2790),n=t(88972),f=t(50781),D=t(81984),y=t(75878),b=t(78549);const W=(0,n.default)(f.x)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:E})=>E.colors.primary600};
  }
`,U=(0,n.default)(f.x)`
  border-radius: 0 0 ${({theme:E})=>E.borderRadius} ${({theme:E})=>E.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,F=({children:E,icon:S,...N})=>(0,e.jsxs)("div",{children:[(0,e.jsx)(D.i,{}),(0,e.jsx)(U,{as:"button",background:"primary100",padding:5,...N,children:(0,e.jsxs)(y.k,{children:[(0,e.jsx)(W,{"aria-hidden":!0,background:"primary200",children:S}),(0,e.jsx)(f.x,{paddingLeft:3,children:(0,e.jsx)(b.Z,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:E})})]})})]})}}]);
